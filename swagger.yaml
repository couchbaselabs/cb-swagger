swagger: '2.0'
info:
  title: Couchbase Server API
  description: API for interacting with Couchbase Server
  version: "4.5.1"

host: 192.168.99.100:8091

schemes:
  - https
  - http

produces:
  - application/json

consumes:
  - application/json
  - formData

securityDefinitions:
  basicAuth:
    type: basic
    description: HTTP Basic Authentication. Works over `HTTP` and `HTTPS`
    
paths:
  /diag:
    get:
      summary: Test
      description: Test
      tags:
        - diag
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /diag/ale:
    get:
      summary: Test
      description: Test
      tags:
        - diag
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /diag/masterEvents:
    get:
      summary: Test
      description: Test
      tags:
        - diag
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /diag/password:
    get:
      summary: Test
      description: Test
      tags:
        - diag
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /diag/vbuckets:
    get:
      summary: Test
      description: Test
      tags:
        - diag
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /indexStatus:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /internalSettings:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /logs:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /nodeStatuses:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /nodes/{node_id}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/NodeID'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /nodes/self/xdcrSSLPorts:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/bucket/{bucket_name}/recoveryStatus:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets:
    get:
      summary: Test
      description: Test
      security:
        - basicAuth: []
      tags:
        - bucket
      responses:
          200:
            description: A json response
            schema:
              type: array
              items:
                - $ref: "#/definitions/Bucket"
              minItems: 0
              uniqueItems: true
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
    post:
      summary: Create a new bucket
      description: This rest endpoint accepts a POST request to create a new bucket.
      security:
        - basicAuth: []
      tags:
        - bucket
      parameters:
        - $ref: "#/parameters/AuthType"
        - $ref: "#/parameters/BucketType"
        - $ref: "#/parameters/EvictionPolicy"
        - $ref: "#/parameters/FlushEnabled"
        - $ref: "#/parameters/FormBucketName"
        - $ref: "#/parameters/ParallelDBAndViewCompaction"
        - $ref: "#/parameters/ProxyPort"
        - $ref: "#/parameters/RamQuotaMB"
        - $ref: "#/parameters/ReplicaIndex"
        - $ref: "#/parameters/ReplicaNumber"
        - $ref: "#/parameters/SaslPassword"
        - $ref: "#/parameters/ThreadsNumber"
      responses:
        202:
          description: The bucket was successfully created
        400:
          description: There was an error with the passed parameters
      
  /pools/default/buckets/@fts-{fts-id}/stats:
    get:
      summary: Test
      description: Test
      parameters:
        - name: fts-id
          type: string
          in: path
          required: true
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/@index-{index-id}/stats:
    get:
      summary: Test
      description: Test
      parameters:
        - name: index-id
          type: string
          in: path
          required: true
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/@query/stats:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/@xdcr-{xdcr-id}/stats:
    get:
      summary: Test
      description: Test
      parameters:
        - name: xdcr-id
          type: string
          in: path
          required: true
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/ddocs:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/docs:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/nodes:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/nodes/{node_id}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
        - $ref: '#/parameters/NodeID'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/nodes/{node_id}/stats:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
        - $ref: '#/parameters/NodeID'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/stats:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/buckets/{bucket_name}/stats/{stat_name}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
        - name: stat_name
          in: path
          required: true
          type: string
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/bucketsStreaming/{bucket_name}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/PathBucketName'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/certificate:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/certificate/node/{node_id}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/NodeID'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/overviewStats:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/rebalanceProgress:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/remoteClusters:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/saslBucketsStreaming:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/serverGroups:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/settings/memcached/effective/{node_id}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/NodeID'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/settings/memcached/global:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/settings/memcached/node/{node_id}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/NodeID'
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/settings/memcached/node/{node_id}/setting/{setting_name}:
    get:
      summary: Test
      description: Test
      parameters:
        - $ref: '#/parameters/NodeID'
        - name: setting_name
          in: path
          type: string
          required: true
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/default/tasks:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /pools/nodes:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /poolsStreaming/default:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /sampleBuckets:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /sasl_logs:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /sasl_logs/{log_name}:
    get:
      summary: Test
      description: Test
      parameters:
        - name: log_name
          type: string
          in: path
          required: true
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/alerts:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/audit:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/autoCompaction:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/autoFailover:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/indexes:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/maxParallelIndexers:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/rbac/roles:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/rbac/users:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/readOnlyAdminName:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/replications:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/replications/{replication_id}:
    get:
      summary: Test
      description: Test
      parameters:
        - name: replication_id
          in: path
          type: string
          required: true
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/saslauthdAuth:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/stats:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/viewUpdateDaemon:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
  /settings/web:
    get:
      summary: Test
      description: Test
      responses:
          200:
            description: A json response
          default:
            description: Unexpected error
            schema:
              $ref: '#/definitions/Error'
              
definitions:
  Error:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      fields:
        type: string
  
  Bucket:
    type: object
    properties:
      name:
        type: string
        example: travel-sample
      bucketType:
        type: string
        enum: ["membase", "memcached"]
        example: membase
      authType:
        type: string
        enum: ["sasl", "none"]
        example: sasl
      saslPassword:
        type: string
        example: password
      proxyPort:
        type: integer
        minimum: 0
        example: 0
      replicaIndex:
        type: boolean
        example: true
      uri:
        type: string
        example: /pools/default/buckets/travel-sample?bucket_uuid=bfaccbdeab775313915cd2cee84cc4b0
      streamingUri:
        type: string
        example: /pools/default/bucketsStreaming/travel-sample?bucket_uuid=bfaccbdeab775313915cd2cee84cc4b0
      localRandomKeyUri:
        type: string
        example: /pools/default/buckets/travel-sample/localRandomKey
      controllers:
        type: object
        properties:
          compactAll:
            type: string
            example: /pools/default/buckets/travel-sample/controller/compactBucket
          purgeDeletes:
            type: string
            example: /pools/default/buckets/travel-sample/controller/unsafePurgeBucket
          startRecovery:
            type: string
            example: /pools/default/buckets/travel-sample/controller/startRecovery
      nodes:
        type: array
        items:
          - $ref: "#/definitions/BucketNode"
      stats:
        type: object
        properties:
          uri:
            type: string
            example: /pools/default/buckets/travel-sample/stats
          directoryURI:
            type: string
            example: /pools/default/buckets/travel-sample/statsDirectory
          nodeStatsListURI:
            type: string
            example: /pools/default/buckets/travel-sample/nodes
      ddocs:
        type: object
        properties:
          uri:
            type: string
            example: /pools/default/buckets/travel-sample/ddocs
      nodeLocator:
        type: string
        example: "vbucket"
      autoCompactionSettings:
        type: boolean
        example: false
      uuid:
        type: string
        example: bfaccbdeab775313915cd2cee84cc4b0
      replicaNumber:
        type: integer
        minimum: 0
        maximum: 3
        example: 1
      threadsNumber:
        type: integer
        minimum: 2
        maximum: 8
        example: 3
      quota:
        type: object
        properties:
          ram:
            type: integer
            example: 104857600
          rawRAM:
            type: integer
            example: 104857600
      basicStats:
        type: object
        properties:
          quotaPercentUsed:
            type: number
            format: float
            example: 68.45857238769531
          opsPerSec:
            type: integer
            example: 30
          diskFetches:
            type: integer
            example: 10
          itemCount:
            type: integer
            example: 31592
          diskUsed:
            type: integer
            example: 147902095
          dataUsed:
            type: integer
            example: 113478832
          memUsed:
            type: integer
            example: 71784016
      evictionPolicy:
        type: string
        enum: ["valueOnly", "fullEviction"]
        example: valueOnly
      timeSynchronization:
        type: string
        example: disabled
      bucketCapabilitiesVer:
        type: string
        example: ""

  BucketNode:
    type: object
    properties:
      couchApiBaseHTTPS:
        type: string
        example: https://172.17.0.2:18092/travel-sample%2Bbfaccbdeab775313915cd2cee84cc4b0
      couchApiBase:
        type: string
        example: http://172.17.0.2:8092/travel-sample%2Bbfaccbdeab775313915cd2cee84cc4b0
      systemStats:
        $ref: "#/definitions/SystemStats"
      interestingStats:
        $ref: "#/definitions/InterestingStats"
      uptime:
        type: string
        example: "88214"
      memoryTotal:
        type: integer
        example: 1044230144
      memoryFree:
        type: integer
        example: 303661056
      mcdMemoryReserved:
        type: integer
        example: 796
      mcdMemoryAllocated:
        type: integer
        example: 796
      replication:
        type: integer
        example: 0
      clusterMembership:
        type: string
        enum: ["active", "inactiveFailed"]
        example: active
      recoveryType:
        type: string
        example: none
      status:
        type: string
        enum: ["healthy"]
        example: healthy
      otpNode:
        type: string
        example: ns_1@127.0.0.1
      thisNode:
        type: boolean
        example: true
      hostname:
        type: string
        example: 192.0.2.0:8091
      clusterCompatibility:
        type: integer
        example: 262149
      version:
        type: string
        example: "4.5.1-2844-enterprise"
      os:
        type: string
        example: "x86_64-unknown-linux-gnu"
      ports:
        type: object
        properties:
          sslProxy:
            type: integer
            example: 11214
          httpsMgmt:
            type: integer
            example: 18091
          httpsCAPI:
            type: integer
            example: 18092
          proxy:
            type: integer
            example: 11211
          direct:
            type: integer
            example: 11210
      services:
        type: array
        items:
          - type: string
            enum: ["fts", "index", "kv", "n1ql"]
            example: "kv"
        uniqueItems: true
      
  SystemStats:
    type: object
    properties:
      cpu_utilization_rate:
        type: number
        format: float
        example: 3.191489361702128
      swap_total:
        type: integer
        example: 1214005248
      swap_used:
        type: integer
        example: 0
      mem_total:
        type: integer
        example: 1044230144
      mem_free:
        type: integer
        example: 284753920
  
  InterestingStats:
    type: object
    properties:
      cmd_get:
        type: number
        format: float
        example: 108.9808274470232
      couch_docs_actual_disk_size:
        type: integer
        example: 101979001
      couch_docs_disk_size:
        type: integer
        example: 92036096
      couch_spatial_data_size:
        type: integer
        example: 21442736
      couch_spatial_disk_size:
        type: integer
        example: 21478927
      couch_views_actual_disk_size:
        type: integer
        example: 21478927
      couch_views_data_size:
        type: integer
        example: 0
      curr_items:
        type: integer
        example: 31592
      curr_items_tot:
        type: integer
        example: 31592
      ep_bg_fetched:
        type: integer
        example: 0
      get_hits:
        type: number
        format: float
        example: 108.9808274470232
      mem_used:
        type: integer
        example: 71766320
      ops:
        type: number
        format: float
        example: 108.9808274470232
      vb_replica_curr_items:
        type: integer
        example: 0
	
parameters:
  PathBucketName:
    name: bucket_name
    in: path
    type: string
    required: true
    description: name of a bucket

  NodeID:
    name: node_id
    type: string
    in: path
    required: true
    description: id of a node
  
  AuthType:
    name: authType
    description: Type of authentication to be used by a bucket.
    in: formData
    type: string
    enum: ["sasl", "none"]
    required: true
    
  BucketType:
    name: bucketType
    description: Type of bucket to create
    in: formData
    type: string
    enum: ["memcached", "couchbase"]
    required: true
  
  EvictionPolicy:
    name: evictionPolicy
    description: Eviction policy to be used by a bucket
    in: formData
    type: string
    enum: ["valueOnly", "fullEviction"]
    default: "valueOnly"
    
  FlushEnabled:
    name: flushEnabled
    description: Whether or not the 'flush' operation is enabled on this bucket
    in: formData
    type: boolean
    default: false
    
  FormBucketName:
    name: name
    description: Name of the bucket
    in: formData
    type: string
    maxLength: 100
    minLength: 1
    required: true

  ParallelDBAndViewCompaction:
    name: parallelDBAndViewCompaction
    description: Indicates whether database and view files on disk can be compacted simultaneously.
    in: formData
    type: boolean
    default: false
    
  ProxyPort:
    name: proxyPort
    description: Proxy port on which the bucket communicates. Must be a valid network port which is not already in use. You must provide a valid port number if the authorization type is not SASL.
    in: formData
    type: integer
  
  RamQuotaMB:
    name: ramQuotaMB
    description: RAM Quota for new bucket in MB. The maximum can only be as great as the memory quota established for the node. If other buckets are associated with a node, RAM Quota can only be as large as the amount memory remaining for the node, accounting for the other bucket memory quota.
    in: formData
    type: integer
    minimum: 100
    required: true
  
  ReplicaIndex:
    name: replicaIndex
    description: Whether replica view indexing is enabled for this bucket.
    in: formData
    type: boolean
    default: true
    
  ReplicaNumber:
    name: replicaNumber
    description: Number of replicas for the bucket.
    in: formData
    type: integer
    minimum: 0
    maximum: 3
    default: 1
  
  SaslPassword:
    name: saslPassword
    description: Password for SASL authentication. Required if SASL authentication has been enabled. An empty string represents having no password
    in: formData
    type: string
    maxLength: 24
  
  ThreadsNumber:
    name: threadsNumber
    description: The bucket I/O priority. 3 represents 'low' priority while 8 represents 'high' priority.
    in: formData
    type: integer
    enum: [3, 8]
    default: 3
